<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">
    <title>Конвертер изображений в текст</title>
</head>
<body>
<div class="container">
  <h2>Конвертер изображений в текст</h2>
  <img class="logo" src="./assets/logo.svg">
    <input type="file" id="imageInput" accept="image/*">
    <button class="save_button" onclick="convertImageToText()">Сохранить в текст</button>
    <div id="loader" class="loader" style="display: none;"></div>
    <pre id="textOutput"></pre>
    <p>Поддерживаются английский и русский языки</p> 
    <p>Форматы изображений: bmp, jpg, png, pbm, webp</p>
  <footer>
    <span>Разработано:</span><a href="https://github.com/poposhka1990" target="_blank"><img class="github_logo" src="./assets/github-logo.svg"></a>
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@2"></script>
<script>
  function convertImageToText() {
    const image = document.getElementById('imageInput').files[0];
    if (image) {
      document.getElementById('loader').style.display = 'block'; // Показываем индикатор загрузки
      Tesseract.recognize(
        image,
        'eng+rus', // Измените на нужный язык
        {
          logger: m => console.log(m)
        }
      ).then(({ data: { text } }) => {
        document.getElementById('loader').style.display = 'none'; // Скрываем индикатор загрузки
        document.getElementById('textOutput').textContent = text;
        saveTextAsFile(text);
      });
    } else {
      alert('Пожалуйста, выберите изображение для конвертации.');
    }
  }

  function saveTextAsFile(text) {
    const blob = new Blob([text], { type: 'text/plain' });
    const anchor = document.createElement('a');
    anchor.download = 'converted-text.txt';
    anchor.href = window.URL.createObjectURL(blob);
    anchor.click();
    window.URL.revokeObjectURL(anchor.href);
  }
</script>
</body>
</html>